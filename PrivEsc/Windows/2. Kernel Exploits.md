The windows kerner can contain several vulnerabilities that can enable an attacker to gain elevated privileges. Patching systems is a difficult process for organizations. 

Windows kernel sploit list can be found [here](https://github.com/njahrckstr/Windows_Kernel_Sploit_List).

### Enumerating installed patches 
- `wmic qfe get Caption,Description,HotFixID,InstalledOn` to get the patch levels. alternately, use the ccommand with `| findstr /C:"KB.." /C:"KB.."` to search for specific KB patch number. 
- The metasploit module, `post/windows/gather/enum_patches`, can also be used to enumerate patches and find their associated vulnerabilities. (requires meterpreter session)
- [Windows Exploit Suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester) can find vulnerabilities associated with the patch. Requries a copy of *system info*.
	- `chmod +x windows-exploit-suggester.py` to make it executable
	- `sudo windows-exploit-suggester.py --update` to download/update the database.
	- `windows-exploit-suggester.py -d <database> -i <systeminfo>`
		- use flag `-l` for local exploits and `-r` for remote exploits.

- [Windows Exploit Suggester New Generation (wesng)](https://github.com/bitsadmin/wesng) is the updated version. (preffered method)
	- `wes.py --update` to download/update the database
	- `wes.py <systeminfo>`
		- use flags `-e` for exploitd and `-i "<search term>"` for include string.
		- example: `wes.py <systeminfo> -e -i "privilege"`
		- use flag `--muc-lookup` to verfy findings and remove false positives. 
			- needs *mechanicalsoup*
			- `sudo pip3 install mechanicalsoup`
		
- [Sherlock](https://github.com/rasta-mouse/Sherlock) is a powershell script that finds missing patches that can be exploited for local privilege escalation. (No longer supported)
	- `Import-Module <sherlock>`
	- `find-AllVulns`
- [Watson](https://github.com/rasta-mouse/Watson) is a .NET tool that runs on the target machine. Successor of sherlock. Simply run the .exe file and get results. 

### Additional resources

1. Pentest labs [article](https://pentestlab.blog/2017/04/24/windows-kernel-exploits/) of windows kernel exploitation.
2. Hacking articles [blog](https://www.hackingarticles.in/post-exploitation-using-wmic-system-command/) by Raj Chandel for windows post exploitation using WMIC.

